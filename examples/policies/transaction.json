{
  "version": "2024-10-24",
  "default_effect": "DENY",
  "policies": [
    {
      "name": "withdrawal-override",
      "description": "Control withdrawals based on transaction attributes and user role",
      "rules": [
        {
          "id": "deny_exceed_amount",
          "description": "Exceed allowed amount",
          "effect": "DENY",
          "condition": "transaction.amount_numeric > 99.9"
        },
        {
          "id": "deny_untrusted_role",
          "description": "Deny withdrawals when the requester is not a trusted role",
          "effect": "DENY",
          "condition": "transaction.user.role == nil || transaction.user.role == '' || transaction.user.role not in ['admin', 'owner']"
        },
        {
          "id": "allow_trusted_role_withdrawal",
          "description": "Allow admins or owners to initiate outbound withdrawals",
          "effect": "ALLOW",
          "condition": "transaction.user.role in ['admin', 'owner'] && transaction.direction == 'out'"
        }
      ]
    }
  ]
}
